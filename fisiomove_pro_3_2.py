<FULL CODE OMITTED FOR BREVITY - see previous message>